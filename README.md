# KID for PRIIPs

In the PRIIPs (Packaged Retail and Insurance-based Investment Products) regulation of the European Union (No. 1286/2014) the KID (Key Information Document) is defined as a measure to improve investor protection. The document specified in the regulation consists of at most three pages presenting the details of a financial product, a risk indicator, different scenarios for the behavior of the product over time, as well a disclosure of the costs inherent to the product. In the [annexes](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32017R0653) the exact form of the document and the calculation methodologies are specified.

## Template

The templates for the Key Information Documents can be specified in any format that a [Pandoc](https://pandoc.org) reader exists. All the files are read and combined into a language specific template, represented as an abstract syntax tree _AST_ for a Pandoc document.

The template definitions provide the required expressiveness in order to define the full document structure, where _Span_ elements are used as nodes representing variables, for example the variable for the _one year stress scenario, formatted with 2 digits after the decimal point_ can be specified in a template as follows (the _id_ of the _Span_ references a certain node and with the _class_ we can specify the formatting):

#### HTML
```html
<span id="strs_one_year" class="2_digits"></span>
```

#### Markdown
```markdown
[]{#strs_one_year .2_digits}
```

#### Native
```
Span ("strs_one_year",["2_digits"],[]) []
```

## Document

A document is generated by replacing the _Span_ elements in the _AST_ with the provided values for the terms with respect to the given formatting specifications and then transforming it into a specific output format by a Pandoc writer. Layouting is accomplished by style-sheet transformations (i.e. cls, css, etc.) of the given output format.

### Command line application

#### Markdown
```bash
$cabal exec kid-document-exe -- --file=test/example/terms.json --lang=DE | pandoc -f native -t markdown
```

Alternatively load the template at runtime and apply the substitution of the variables with a [Pandoc filter](https://pandoc.org/filters.html).
